<div class="post-card" *ngIf="post">
  <div class="post-header" (click)="navigateToProfile()">
    <div class="avatar-wrapper">
      <img [src]="post.avatar" alt="avatar" (error)="$event.target.src='/avatarka.jpg'">
    </div>
    <span class="username">{{ post.username }}</span>
  </div>

  <div class="post-image">
    <img 
      [src]="post.image" 
      alt="content"
      (error)="handleImageError($event)"
      loading="lazy"
    >

    <div class="image-overlay">
      <button 
        class="action-btn heart" 
        [class.active]="post.isLiked"
        (click)="toggleLike(); $event.stopPropagation()"
        [disabled]="isLiking"
      >
        {{ post.isLiked ? '‚ù§Ô∏è' : 'ü§ç' }}
      </button>
      <button 
        class="action-btn message" 
        (click)="toggleComments(); $event.stopPropagation()"
      >
        üí¨
      </button>
    </div>
  </div>

  <div class="post-footer">
    <div class="post-actions">
      <button 
        class="action-btn-text"
        [class.active]="post.isLiked"
        (click)="toggleLike()"
        [disabled]="isLiking"
      >
        ‚ù§Ô∏è {{ post.likesCount || 0 }}
      </button>
      <button 
        class="action-btn-text"
        (click)="toggleComments()"
      >
        üí¨ {{ post.commentsCount || 0 }}
      </button>
    </div>

    <p class="description">
      <strong>{{ post.username }}</strong> {{ post.description }}
    </p>

    <div class="comments-section" *ngIf="showComments">
      <div class="comments-list" *ngIf="post.comments && post.comments.length > 0">
        <div class="comment-item" *ngFor="let comment of post.comments; trackBy: trackByCommentId">
          <div class="comment-avatar">
            <img [src]="comment.avatar" alt="avatar" (error)="$event.target.src='/avatarka.jpg'">
          </div>
          <div class="comment-content">
            <strong class="comment-username">{{ comment.username }}</strong>
            <span class="comment-text">{{ comment.text }}</span>
          </div>
        </div>
      </div>

      <div class="comment-form">
        <input 
          type="text" 
          class="comment-input"
          [(ngModel)]="commentText"
          placeholder="–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."
          (keyup.enter)="addComment()"
          [disabled]="isCommenting"
        >
        <button 
          class="comment-submit"
          (click)="addComment()"
          [disabled]="!commentText.trim() || isCommenting"
        >
          –û—Ç–ø—Ä–∞–≤–∏—Ç—å
        </button>
      </div>
    </div>

    <span class="post-time">{{ getTimeAgo(post.createdAt) }}</span>
  </div>
</div>
